# Задание 2: ERP-система

### Условие задачи:

Фирма «Меркурий» занимается покупкой и перепродажей товаров. В учете используются две
категории документов: банковские и складские. И те и другие бывают двух типов: приходные и
расходные.

Банковские документы содержат в себе информацию о движении денег по расчетным счетам.
Более строго, банковский документ характеризуется следующими параметрами: 

Параметр | Ограничения
---------|------------
Тип движения | Приход или расход
Номер документа | Натуральное число не превышающее `10^6`
Дата и время документа | Формат `дд.мм.гггг чч:мм`
Контрагент | Строка из `30` символов, представляющая наименование компании, с которой совершается сделка
Счет | Число, состоящее из 20 цифр, ведущие нули допускаются
Сумма | Вещественное число, с точностью до двух десятичных знаков и не превышающее `10^6`

При этом приходный банковский документ описывает приход денег на наш счет от контрагента. Расходный - наоборот. Расчетных счетов у «Меркурий» несколько.

Складские документы содержат в себе информацию о движении товаров. Более строго, складской документ характеризуется следующими параметрами:

Параметр | Ограничения
---------|------------
Тип движения | Приход или расход
Номер документа | Натуральное число не превышающее `10^6`
Дата и время документа | Формат `дд.мм.гггг чч:мм`
Контрагент | Строка из `30` символов, представляющая наименование компании, с которой совершается сделка
Таблица товаров | Таблица с количеством строк не более `10^3`. Колонками являются Товар, Количество и Сумма. Строки описывают, какие товары были куплены/проданы, с указанием количества и суммы за эту партию.

Таблица товаров характеризуется следующими колонками:

Параметр | Ограничения
---------|------------
Товар | Строка из 30 символов, представляющая наименование товара
Количество | Вещественное число, с точностью до трех десятичных знаков и не превышающее `10^6`
Сумма | Вещественное число, с точностью до двух десятичных знаков и не превышающее `10^6`

Клиенты могут быть и покупателями и поставщиками одновременно. 
Приходный складской документ описывает поступление товаров на единственный склад фирмы «Меркурий».
Расходный – наоборот.
Каждый товар в Таблице товаров складского документа встречается один раз. 
Номера документов (обеих категорий), а также дата и время уникальны в рамках всей системы учета.
Вам предоставляется набор документов принятых к учету с открытия фирмы «Меркурий».
Документы в систему учета вносятся в произвольном порядке, но при этом дата документа определяет фактическую дату сделки. 
Требуется написать программу, которая будет осуществлять контроль над документооборотом.
Контролировать необходимо три аспекта: деньги на счетах, товары на складах и контрагентов.
Если в какой-то момент времени на одном из счетов оказывается отрицательная сумма денег, то набор документов содержит ошибку пользовательского ввода. 
Если в какой-то момент времени количественный остаток одного из товаров оказывается отрицательным, то набор документов содержит ошибку пользовательского ввода. 
Если набор документов не содержит ошибок пользовательского ввода, то необходимо знать каким контрагентам задолжал «Меркурий, какие контрагенты задолжали «Меркурию» и сколько.

##### Примечание: 
При открытии фирмы «Меркурий» на счет с номером «11111111111111111111» были внесены средства в размере `100000` (начальный капитал).

### Формат входного файла
В первой строке указывается число `N` `(0 ≤ N ≤ 10^5)` – количество документов.
Далее следует описание `N` документов. Банковские документы описываются одной строкой, складские строкой заголовка, а затем каждый товар в одной строке.
Идентификатор документа это одно из четырех значений `BI`, `BW`, `WI` или `WW`.
Каждый идентификатор определяет категорию документа и тип (*bank*/*warehouse* и *income*/*withdraw*).
Описание банковского документа представляет собой следующую последовательность значений: Идентификатор, Номер, Дата и время, Контрагент, Счет, Сумма. 
Все значения разделены одиночными пробелами. Контрагент декорируется символом апостроф (\`) с обеих сторон.
Описание складского документа представляет собой следующую последовательность значений: Идентификатор, Номер, Дата и время, Контрагент, количество строк в Таблице товаров. 
Далее следует описание Таблицы товаров. Каждая строка таблицы в отдельной строке файла. Описание одной строки таблицы представляет собой: Товар, Количество, Сумма. 
Все значения в строках разделены одиночными пробелами.
Контрагент и товар декорируются символом апостроф (\`) с обеих сторон.

### Формат выходного файла
В случае отсутствия ошибки пользовательского ввода, в первой строке должно быть выведено слово «**OK**», а также количество контрагентов, с которыми у «Меркурия» были сделки.
Далее нужно вывести информацию по всем контрагентам с указанием сумм их задолженности перед «Меркурий». 
Список выводится в порядке убывания значений задолженности. 
В одной строке файла выводится информация о задолженности только одного контрагента в формате: имя контрагента, задолженность. 
В случае если у двух контрагентов образовалась одинаковая задолженность, их надо выводить в лексикографическом порядке наименований. 
В случае ошибки с отрицательным остатком товара, в первой строке необходимо указать слово «**ERROR**», а затем Идентификатор и Номер документа вызвавшего ошибку, а также количество Товаров вызвавших ошибку в этом документе. 
В следующих строках необходимо описать Товары, по которым получились отрицательные остатки.
Для этого в каждой строке нужно вывести Товар и недостающее количество этого товара (отрицательное число). 
Товары выводятся в лексикографическом порядке их наименований.
В случае ошибки с отрицательной суммой на счету, в первой строке необходимо указать слово
«**ERROR**», а затем Идентификатор и Номер документа вызвавшего ошибку. 
Во второй строке необходимо указать номер счета и недостающую сумму (отрицательное число).
 
Лектор: Штейнберг Роман Борисович.

Осень 2016, ЮФУ.